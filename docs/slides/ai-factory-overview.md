---
marp: true
theme: default
paginate: true
header: "AI Factory v2.6"
footer: "GitHub Issue駆動の完全自動開発パイプライン"
---

# AI Factory v2.6

## GitHub Issue 駆動の完全自動開発パイプライン
## + 継続的改善（Kaizen）システム

---

# このプロジェクトが解決する課題

## 現状の開発現場の問題

| 課題 | 詳細 |
|------|------|
| **繰り返し作業** | テスト作成、実装、レビュー、PR作成などの定型業務 |
| **知識の散逸** | 開発経験が個人に埋もれ、チームで共有されない |
| **品質管理の負担** | 手動レビューとテスト実行に時間がかかる |
| **スケーラビリティ** | 小規模チームでは大規模開発に対応困難 |

---

# AI Factory のビジョン

## 目指す世界

```
GitHub Issue を書くだけで
    ↓
設計 → テスト → 実装 → レビュー → PR作成
    ↓
すべて自動で完了
```

**人間は「何を作るか」に集中し、「どう作るか」はAIが担当**

---

# システム全体像

![bg right:40% 80%](https://via.placeholder.com/400x600/4A90A4/FFFFFF?text=AI+Factory)

## 3つのフェーズ

1. **企画フェーズ**
   仕様策定 → レビュー → Issue分解

2. **実装フェーズ**
   テスト → 実装 → 監査 → ドキュメント

3. **改善フェーズ**
   マージ → 検証 → 知識蓄積

---

# 9つの専門AIエージェント

## マルチエージェント協調開発

| フェーズ | エージェント | 役割 |
|:-------:|:------------|:-----|
| 企画 | **Product Manager** | ユーザーと対話して仕様書作成 |
| 企画 | **Critic** | 仕様書のレビュー・承認判定 |
| 企画 | **Issue Planner** | 仕様書をIssueに分解 |

---

# 9つの専門AIエージェント（続き）

| フェーズ | エージェント | 役割 |
|:-------:|:------------|:-----|
| 実装 | **QA Engineer** | テストケース設計・pytest作成 |
| 実装 | **Coder** | テストを通過する実装コード作成 |
| 実装 | **Tech Lead** | 静的解析・変異テストで品質検証 |
| 実装 | **Librarian** | アーキテクチャドキュメント更新 |

---

# 9つの専門AIエージェント（続き）

| フェーズ | エージェント | 役割 |
|:-------:|:------------|:-----|
| 改善 | **Validator** | マージ後の統合検証 |
| 改善 | **Scrum Master** | 知識蒸留（学びをclaude.mdに蓄積） |

**→ 9つのAIが「チーム」として協調動作**

---

# コマンド体系

## 一気通貫コマンド（3つ）

| コマンド | 説明 | 実行フロー |
|---------|------|-----------|
| `/prepare` | 企画フェーズ | spec → critique → breakdown |
| `/run {id}` | 実装フェーズ | test → impl → review → sync → kaizen |
| `/auto` | 全Issue自動処理 | 複数の /run を順次実行 |

---

# コマンド体系（続き）

## 個別コマンド（8つ）

| コマンド | エージェント | 出力 |
|---------|------------|------|
| `/spec` | Product Manager | 仕様書 |
| `/critique` | Critic | APPROVED / REQUEST_CHANGES |
| `/breakdown` | Issue Planner | GitHub Issues |
| `/test` | QA Engineer | tests/test_*.py |
| `/impl` | Coder | src/* |
| `/review` | Tech Lead | 品質レポート |
| `/sync` | Librarian | docs/architecture/*.md |
| `/kaizen` | Scrum Master | claude.md更新 |

---

# 企画フェーズの流れ

```
ユーザー「こんな機能が欲しい」
         ↓
┌─────────────────────────────────┐
│  Product Manager               │
│  ・ヒアリング（対話）            │
│  ・仕様書作成                    │
│  出力: docs/specs/spec-*.md     │
└─────────────────────────────────┘
         ↓
┌─────────────────────────────────┐
│  Critic                        │
│  ・仕様の矛盾チェック            │
│  ・実現可能性評価                │
│  判定: APPROVED / REQUEST_CHANGES│
└─────────────────────────────────┘
```

---

# 企画フェーズの流れ（続き）

```
         ↓ （承認後）
┌─────────────────────────────────┐
│  Issue Planner                 │
│  ・実装可能な単位に分解          │
│  ・依存関係の整理                │
│  出力: GitHub Issues (label:todo)│
└─────────────────────────────────┘
         ↓
Issue #1, #2, #3... が自動作成される
```

---

# 実装フェーズの流れ

```
GitHub Issue (label:todo)
         ↓
┌─────────────────────────────────┐
│  QA Engineer                   │
│  ・テストケース設計              │
│  ・pytest コード作成             │
│  出力: tests/test_*.py          │
└─────────────────────────────────┘
         ↓
┌─────────────────────────────────┐
│  Coder                         │
│  ・TDDで実装                     │
│  ・テスト失敗 → 修正 → 再テスト   │
│  出力: src/*                    │
└─────────────────────────────────┘
```

---

# 実装フェーズの流れ（続き）

```
         ↓ （テスト成功後）
┌─────────────────────────────────┐
│  Tech Lead                     │
│  ・静的解析（ruff, mypy）        │
│  ・変異テスト（mutmut 80%以上）   │
│  判定: ✅ Approved / 🚨 Reject  │
└─────────────────────────────────┘
         ↓ （Approved後）
┌─────────────────────────────────┐
│  Librarian                     │
│  ・アーキテクチャドキュメント更新  │
│  出力: docs/architecture/*.md   │
└─────────────────────────────────┘
         ↓
PR 自動作成
```

---

# 品質管理の多層防御

## 4段階の品質チェック

```
実装コード
    ↓
┌──────────────────┐
│ 1. pytest        │  ユニットテスト
└──────────────────┘
    ↓
┌──────────────────┐
│ 2. ruff          │  コードスタイル・バグ検出
└──────────────────┘
    ↓
┌──────────────────┐
│ 3. mypy          │  型チェック
└──────────────────┘
    ↓
┌──────────────────┐
│ 4. mutmut        │  変異テスト（テスト品質検証）
└──────────────────┘
```

---

# 変異テストとは？

## テストの「テスト」

```python
# 元のコード
def is_adult(age):
    return age >= 18

# 変異体（mutant）
def is_adult(age):
    return age > 18   # >= を > に変更
```

**良いテストなら変異体を「殺す」（テスト失敗させる）**

→ 80%以上の変異体を殺せないとReject

---

# Kaizen（継続的改善）

## 知識蒸留の3ステップ

### Step 1: 作業メモの記録

各エージェントが作業中に得た学びを自動記録

```
.claude/factory/memos/
├── issue-42-qa.md
├── issue-42-coder.md
├── issue-42-tech_lead.md
└── issue-42-librarian.md
```

---

# Kaizen（続き）

### Step 2: 知識の蒸留

**Scrum Master** が全エージェントのメモを収集

- Issue固有の内容を除外
  - ❌ 「#42のバグを修正」
- 汎用的な学びを抽出
  - ✅ 「pydantic v2では型アノテーションが必須」

---

# Kaizen（続き）

### Step 3: 知識の再利用

```
root/
├── claude.md              ← プロジェクト全体の学び
├── src/
│   ├── claude.md          ← src関連の学び
│   └── utils/
│       └── claude.md      ← utils関連の学び
└── tests/
    └── claude.md          ← テスト関連の学び
```

**次回実装時に各エージェントが自動参照**

---

# 並列実行対応

## 複数ターミナルで同時実行可能

```bash
# ターミナル1
claude -p "/auto"

# ターミナル2
claude -p "/auto"
```

## 競合防止メカニズム

1. アサイン前にassignee確認（0件であること）
2. 自分をアサイン
3. 2秒待機後に再確認
4. 競合発生時はロールバック

---

# Git Worktree による分離

## 各Issueごとに独立した作業ディレクトリ

```bash
.claude/worktrees/
├── task-42/    ← Issue #42 の作業ディレクトリ
├── task-43/    ← Issue #43 の作業ディレクトリ
└── task-44/    ← Issue #44 の作業ディレクトリ
```

**利点:**
- 複数Issueの同時処理が可能
- ブランチの衝突なし
- クリーンアップが容易

---

# エラーハンドリング

## 自動リトライメカニズム

| 設定 | 値 |
|------|-----|
| 最大リトライ回数 | 3回 |
| リトライ対象 | テスト失敗、実装エラー、マージ失敗 |
| 最終手段 | `failed` ラベル付与 → 手動修正へ |

---

# エラー報告の例

```markdown
## ❌ 実装失敗

### 失敗フェーズ
フェーズ3: 実装

### エラー内容
pytest failed: 2 tests failed

### 試行した対応
- 型エラーの修正を試行（3回リトライ）

### 推奨アクション
- Issue の要件を再確認
- 手動でテストを実行して原因調査
```

---

# 技術スタック

## 使用ツール

| ツール | 用途 |
|--------|------|
| **Claude Code** | AIエージェント実行基盤 |
| **uv** | Python パッケージマネージャー |
| **pytest** | ユニットテスト |
| **ruff** | Linter / Formatter |
| **mypy** | 型チェック |
| **mutmut** | 変異テスト |
| **gh (GitHub CLI)** | GitHub API操作 |

---

# ディレクトリ構成

```
.claude/
├── agents/          # 9つのAIエージェント定義
│   ├── pm.md
│   ├── critic.md
│   ├── planner.md
│   ├── qa.md
│   ├── coder.md
│   ├── tech_lead.md
│   ├── librarian.md
│   ├── scrum_master.md
│   └── validator.md
├── commands/        # 11個のコマンド定義
├── factory/         # コアシステム（設定、通知、ログ）
└── rules/           # コーディング規約
```

---

# 使い方：新規プロジェクト

## Step 1: 企画フェーズ

```bash
claude -p "/prepare"
```

対話形式で要件をヒアリング
    ↓
仕様書作成 → レビュー → Issue分解
    ↓
GitHub Issues が自動作成される

---

# 使い方：実装フェーズ

## Step 2: 全Issue自動処理

```bash
claude -p "/auto"
```

label:todo の Issue を順次処理
    ↓
テスト → 実装 → 監査 → PR作成
    ↓
すべてのIssueが完了するまで継続

---

# 使い方：マージ

## Step 3: PRマージと検証

```bash
claude -p "/merge"
```

最古のtodo IssueのPRをマージ
    ↓
統合検証（Validator）
    ↓
Issueクローズ

---

# 長期ビジョン

## AIネイティブ開発パイプライン

### 短期目標
- GitHub Issue → PR作成まで完全自動化
- 多層的な品質管理

### 中期目標
- Kaizenによる知識蓄積と再利用
- 複数リポジトリ対応

### 長期ビジョン
- 人間のコードレビュー不要なレベル
- AI駆動開発の業界標準化

---

# まとめ

## AI Factory v2.6 の特徴

1. **9つの専門AIエージェント**
   企画から実装、マージ後検証まで全フェーズをカバー

2. **11個のコマンド**
   一気通貫コマンドで簡単操作

3. **Kaizen機能**
   開発経験を自動蓄積し、継続的改善

4. **高い品質保証**
   TDD、静的解析、変異テストで多層的な品質管理

5. **スケーラビリティ**
   並列実行対応、複数Issue同時処理

---

# お問い合わせ

## AI Factory v2.6

**GitHub Issue を書くだけで、あとはAIにお任せ**

---

<!--
_class: lead
_paginate: false
-->

# Thank You

## AI Factory v2.6
### GitHub Issue 駆動の完全自動開発パイプライン
